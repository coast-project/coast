#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------
{

#	RegExpFilterFieldsResultMapper
	/RegexFieldsMapperPositiveWithCase {
		/PositiveWithCase {
			/^content	*
		}
	}
	/RegexFieldsMapperPositiveCaseless {
		/MatchFlags		1	# caseless matching
		/PositiveCaseless {
			/^content	*
		}
	}
	/RegexFieldsMapperExplicitNoRecursionTest {
		/ExplicitNoRecursionTest {
			/server	*
		}
	}
	/RegexFieldsMapperAll {
		/All {
			/.			*
		}
	}
	/RegexFieldsMapperNone {
		/None {
		}
	}
	/RegexFieldsMapperAllWithoutSome {
		/AllWithoutSome {
			/"(server|^x-)"	"-"
			/.				*
		}
	}
	/RegexFieldsMapperCodeExample {
		/DestinationSlot SomeWhere
		/MatchFlags		1
		/CodeExample {
			/"^content"	{			# execute Mapper script for entries starting with accept
				/RootMapper	*
			}
			/"^server"	"-"			# do not map this entry
			/"."		*			# catch all others and do default putting
		}
	}
	/RegExpFilterFieldsResultMapperDA {
		/CodeExample {
			/RegexFieldsMapperCodeExample *
		}
		/PositiveWithCase {
			/RegexFieldsMapperPositiveWithCase *
		}
		/PositiveCaseless {
			/RegexFieldsMapperPositiveCaseless *
		}
		/ExplicitNoRecursionTest {
			/RegexFieldsMapperExplicitNoRecursionTest *
		}
		/All {
			/RegexFieldsMapperAll *
		}
		/None {
			/RegexFieldsMapperNone *
		}
		/AllWithoutSome {
			/RegexFieldsMapperAllWithoutSome *
		}
	}

	/RegexFieldsMapperTest {
		/TmpStore {
			/HTTPHeader {
				/connection "close"
				/date "Thu, 11 Nov 2010 08:30:36 GMT"
				/server "Microsoft-IIS/6.0"
				/x-powered-by "ASP.NET"
				/x-aspnet-version "2.0.50727"
				/set-cookie "ASP.NET_SessionId=csjgcsewg42bva45tsexdu45; path=/; HttpOnly"
				/cache-control "private"
				/content-type "text/html; charset=utf-8"
				/content-length "4611"
				/CONTENT-TYPE "text/html; charset=utf-8; uppercase"
				/CONTENT-LENGTH "4611; uppercase"
			}
			/ExampleInput {
				/connection "close"
				/date "Thu, 11 Nov 2010 08:30:36 GMT"
				/server "Microsoft-IIS/6.0"
				/x-powered-by "ASP.NET"
				/x-aspnet-version "2.0.50727"
				/cache-control "private"
				/content-type "text/html; charset=utf-8"
				/content-length "4611"
			}
		}
		/TheAction {
			/CallDataAccessAction	RegExpFilterFieldsResultMapperDA
		}
		/ExpectedResult 1
		/NotResult {
			/TmpStore {
				/PositiveWithCase {
					/connection *
					/date *
					/server *
					/x-powered-by *
					/x-aspnet-version *
					/set-cookie *
					/cache-control *
					/CONTENT-TYPE *
					/CONTENT-LENGTH *
				}
				/PositiveCaseless {
					/connection *
					/date *
					/server *
					/x-powered-by *
					/x-aspnet-version *
					/set-cookie *
					/cache-control *
				}
				/ExplicitNoRecursionTest {
					/connection *
					/date *
					/x-powered-by *
					/x-aspnet-version *
					/set-cookie *
					/cache-control *
					/content-type "text/html; charset=utf-8"
					/content-length "4611"
					/CONTENT-TYPE *
					/CONTENT-LENGTH *
				}
				/AllWithoutSome {
					/server *
					/x-powered-by *
					/x-aspnet-version *
				}
				/None *
				/SomeWhere {
					/CodeExample {
						/server "Microsoft-IIS/6.0"
						/content-type "text/html; charset=utf-8"
						/content-length "4611"
					}
				}
				/CodeExample {
					/connection "close"
					/date "Thu, 11 Nov 2010 08:30:36 GMT"
					/server "Microsoft-IIS/6.0"
					/x-powered-by "ASP.NET"
					/x-aspnet-version "2.0.50727"
					/cache-control "private"
				}
			}
		}
		/Result {
			/TmpStore {
				/PositiveWithCase {
					/content-type "text/html; charset=utf-8"
					/content-length "4611"
				}
				/PositiveCaseless {
					/content-type "text/html; charset=utf-8"
					/content-length "4611"
					/CONTENT-TYPE "text/html; charset=utf-8; uppercase"
					/CONTENT-LENGTH "4611; uppercase"
				}
				/ExplicitNoRecursionTest {
					/server "Microsoft-IIS/6.0"
				}
				/All %TestCases.RegexFieldsMapperTest.TmpStore.HTTPHeader
				/AllWithoutSome {
					/connection "close"
					/date "Thu, 11 Nov 2010 08:30:36 GMT"
					/set-cookie "ASP.NET_SessionId=csjgcsewg42bva45tsexdu45; path=/; HttpOnly"
					/cache-control "private"
					/content-type "text/html; charset=utf-8"
					/content-length "4611"
					/CONTENT-TYPE "text/html; charset=utf-8; uppercase"
					/CONTENT-LENGTH "4611; uppercase"
				}
				/SomeWhere {
					/CodeExample {
						/connection "close"
						/date "Thu, 11 Nov 2010 08:30:36 GMT"
						/x-powered-by "ASP.NET"
						/x-aspnet-version "2.0.50727"
						/cache-control "private"
					}
				}
				/CodeExample {
					/content-type "text/html; charset=utf-8"
					/content-length "4611"
				}
			}
		}
	}


	/ConfiguredTests {
	}{
		/SingleCookiePutTest {
			/Value {
#				".ASPXAUTH=1D465C16E0F200E2D948F64072EF5762F896AA8F37F22A628F9E67D03A776DCA1BFCF9AACEFB52AEED2852A32817A1D7C8E408EFDD7DC5952DC385CC4A87667C47B84B80D2E642CFE19EDD98EB500B72; path=/"
				".ASPXAUTH=0B26FEB5F5C9DD90554CC9F6884B1AC57C010401C04A9F1EA6703DD4587C8D76F12F3BC6D3D04E3703165D69B8F33D5F66A037BCB75893BDE1D68A6EBCF92DF9CC4059659A41F8614387AE5E40092B35; path=/; secure; HttpOnly"
			}
			/Putkey "HTTPHeader.SET-COOKIE"
			/MapperConfig {

			}
			/Expected {
				gugus
			}
		}
	}

	/.ASPXAUTH {
#		{
#			/_value_ "1D465C16E0F200E2D948F64072EF5762F896AA8F37F22A628F9E67D03A776DCA1BFCF9AACEFB52AEED2852A32817A1D7C8E408EFDD7DC5952DC385CC4A87667C47B84B80D2E642CFE19EDD98EB500B72"
#			/_attrs_ {
#				/path "/"
#			}
#		}
		{
			/_value_ "0B26FEB5F5C9DD90554CC9F6884B1AC57C010401C04A9F1EA6703DD4587C8D76F12F3BC6D3D04E3703165D69B8F33D5F66A037BCB75893BDE1D68A6EBCF92DF9CC4059659A41F8614387AE5E40092B35"
			/_attrs_ {
				/path "/"
				"secure"
				"HttpOnly"
			}
		}
	}
}

#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------

{

	/EnvForAllCases {
	}
	/RunOnly {
	}
	/TestCases
	{
		/WholeHeaderConfig
		{

			/Env
			{
				/Data
				{
					"adummyheaderline"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer
				{
					/HeaderSlot "Data"
				}
			}
			/Expected "adummyheaderline"
		}
		/SingleLine1
		{

			/Env
			{
				/Data
				{
					/WWW-Authenticate "NTLM"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer
				{
					/HeaderSlot "Data"
				}
			}
			/Expected "WWW-Authenticate: NTLM\r\n"
		}
		/SingleLine2
		{

			/Env
			{
				/Data
				{
					/WWW-Authenticate "NTLM"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer "Data"
			}
			/Expected "WWW-Authenticate: NTLM\r\n"
		}
		/SingleLineMultiValue
		{

			/Env
			{
				/Data
				{
					/WWW-Authenticate
					{
						"NTLM"
						"Negotiate"
						"Basic"
					}
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer
				{
					/HeaderSlot "Data"
				}
			}
			/Expected "WWW-Authenticate: NTLM, Negotiate, Basic\r\n"
		}
		/MultiLine
		{

			/Env
			{
				/Data
				{
					/WWW-Authenticate	"NTLM"
					/Connection			"close"
					/Content-Type		"text/html"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer
				{
					/HeaderSlot "Data"
				}
			}
			/Expected
					"WWW-Authenticate: NTLM\r\nConnection: close\r\nContent-Type: text/html\r\n"
		}
		/MultiValues1
		{

			/Env
			{
				/Data
				{
					/set-cookie
					{
						"Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;"
						"Test2=test_value2; expires=Sat, 02-Jan-2002 02:02:02 GMT; path=/;"
						"Test3=test_value3; expires=Sat, 03-Jan-2003 03:03:03 GMT; path=/;"
					}
					/set-cookie2
					{
						"Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;"
						"Test2=test_value2; expires=Sat, 02-Jan-2002 02:02:02 GMT; path=/;"
						"Test3=test_value3; expires=Sat, 03-Jan-2003 03:03:03 GMT; path=/;"
					}
					/Connection			"close"
					/Content-Type		"text/html"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer
				{
					/HeaderSlot "Data"
				}
			}
			/Expected
"set-cookie: Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;\r\nset-cookie: Test2=test_value2; expires=Sat, 02-Jan-2002 02:02:02 GMT; path=/;\r\nset-cookie: Test3=test_value3; expires=Sat, 03-Jan-2003 03:03:03 GMT; path=/;\r\nset-cookie2: Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;, Test2=test_value2; expires=Sat, 02-Jan-2002 02:02:02 GMT; path=/;, Test3=test_value3; expires=Sat, 03-Jan-2003 03:03:03 GMT; path=/;\r\nConnection: close\r\nContent-Type: text/html\r\n"
		}
		/MultiValues2
		{

			/Env
			{
				/Data
				{
					/set-cookie
					{
						"Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;"
					}
					/set-cookie2
					{
						"Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;"
					}
					/Connection			"close"
					/Content-Type		"text/html"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer
				{
					/HeaderSlot "Data"
				}
			}
			/Expected
"set-cookie: Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;\r\nset-cookie2: Test1=test_value1; expires=Sat, 01-Jan-2001 01:01:01 GMT; path=/;\r\nConnection: close\r\nContent-Type: text/html\r\n"
		}

		/HTTPHeaderRendererTest1
		{
			/Env
			{
				/TestHeader
				{
					/WWW-Authenticate "NTLM"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer "TestHeader"
			}
			/Expected "WWW-Authenticate: NTLM\r\n"
		}
		/HTTPHeaderRendererTest2
		{
			/Env
			{
				/httpHeader	"TestHeader"
				/TestHeader
				{
					/WWW-Authenticate "NTLM"
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer { /ContextLookupRenderer "httpHeader" }
			}
			/Expected "WWW-Authenticate: NTLM\r\n"
		}
		/HTTPHeaderRendererSpecTest
		{
			/Env
			{
				/forlookup "NTLM"
				/TestHeader
				{
					/WWW-Authenticate { {/ContextLookupRenderer forlookup} }
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer "TestHeader"
			}
			/Expected "WWW-Authenticate: NTLM\r\n"
		}
		/HTTPHeaderRendererWrongSpecTest
		{
			/Env
			{
				/forlookupwrong "NTLM"
				/TestHeader
				{
					/WWW-Authenticate { /ContextLookupRenderer forlookupwrong }
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer "TestHeader"
			}
			/Expected "WWW-Authenticate: forlookupwrong\r\n"
		}

		/HTTPHeaderRendererMultiValueSpecTest
		{
			/Env
			{
				/forlookup1 "NTLM"
				/forlookup2 "Basic"
				/TestHeader
				{
					/WWW-Authenticate {
							{ /ContextLookupRenderer forlookup1 }
							{ /ContextLookupRenderer forlookup2 }
					}
				}
			}
			/Renderer
			{
				/HTTPHeaderRenderer "TestHeader"
			}
			/Expected "WWW-Authenticate: NTLM, Basic\r\n"
		}

	}
}

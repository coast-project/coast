#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------

{

	/testLDAPConnectionManager
	{
		# Setting handle, retrieving it with timeout to high
		{
			/NumberOfRuns 1
			/Get
			{
				/Data
				{
					/UniqueConnectionId		"FristConnection"
					/LDAPRebindTimeout			2
					/SleepTime				3
				}
				/Expected
				{
					/MustRebind				1
				}
			}
			/Set
			{
				/Data
				{
					/LDAPServer		"marvin.hsr.loc"
					/LDAPPort		"49999"
					/UniqueConnectionId		"FristConnection"
				}
				/Expected
				{
					/Return				1
				}
			}
		}
		# Re-Setting same handle, retrieving it with timeout ok
		{
			/NumberOfRuns 1
			/Get
			{
				/Data
				{
					/UniqueConnectionId		"FristConnection"
					/LDAPRebindTimeout			2
					/SleepTime				1
				}
				/Expected
				{
					/MustRebind				0
				}
			}
			/Set
			{
				/Data
				{
					/LDAPServer		"marvin.hsr.loc"
					/LDAPPort		"49999"
					/UniqueConnectionId		"FristConnection"
				}
				/Expected
				{
					/Return				1
				}
			}
		}
		# Setting another handle, retrieving it with timeout ok
		{
			/NumberOfRuns 1
			/Get
			{
				/Data
				{
					/UniqueConnectionId		"SecondConnection"
					/LDAPRebindTimeout			5
					/SleepTime				0
				}
				/Expected
				{
					/MustRebind				0
				}
			}
			/Set
			{
				/Data
				{
					/LDAPServer		"marvin.hsr.loc"
					/LDAPPort		"49999"
					/UniqueConnectionId		"SecondConnection"
				}
				/Expected
				{
					/Return				1
				}
			}
		}
		# Re-Getting this handle, retrieving it with timeout ok
		{
			/NumberOfRuns 5
			/Get
			{
				/Data
				{
					/UniqueConnectionId		"SecondConnection"
					/LDAPRebindTimeout			5
					/SleepTime				0
				}
				/Expected
				{
					/MustRebind				0
				}
			}
		}
	}
}

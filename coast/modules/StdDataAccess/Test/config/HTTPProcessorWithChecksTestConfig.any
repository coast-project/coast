#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------
{
	/Modules {
		CacheHandlerModule
		MappersModule
		ServiceHandlersModule
		ServiceDispatchersModule
		SessionListManager
		ServersModule
	}
	/Mappers {}
	/ServiceHandlers {}
	/ServiceDispatchers {}
	/SessionListManager {}
	/DataAccessImpls {}
	/Servers { /Server * }

	/NoPoolManager	1

	/CheckFaultyHeadersTest {
		/OnlyQuerySuccess {
			/RequestLine 	"GET ?bar HTTP/1.0\r\n\r\n"
			/Expected {
				/Reply	"HTTP/1.1 404 Not Found"
				/Request {
					/env {
						/REQUEST_URI "?bar"
					}
				}
			}
		}
		/OnlyRootURISuccess {
			/RequestLine 	"GET / HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/SimpleFileURISuccess {
				/RequestLine 	"GET /ftimage/image.gif HTTP/1.0\r\n\r\n"
				/Expected {
					/Request {
						/env {
							/REQUEST_URI "/ftimage/image.gif"
						}
					}
					/Reply "HTTP/1.1 404 Not Found"
				}
		}
		/EncodedPathSeparatorSuccess {
				/RequestLine 	"GET %2Fftimage%2Fimage.gif HTTP/1.0\r\n\r\n"
				/Expected {
					/Request {
						/env {
							/REQUEST_URI "/ftimage/image.gif"
						}
					}
					/Reply "HTTP/1.1 404 Not Found"
				}
		}
		/IllegalServerProtocolFormat {
				/RequestLine 	"GET %2F HTTP%2F1.0\r\n\r\n"
				/Expected {
					/Request {
						/env {
						}
					}
					/Reply "HTTP/1.1 400 Bad Request"
				}
		}

		/RelativeBackMovementAttack {
			/RequestLine 	"GET /ftimage/subimage/../../etc/shadow HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}

		}
		/RelativeBackMovementAttackAgain {
			/RequestLine 	"GET /../../../../etc/shadow HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/RelativeBackMovementAttackWithArguments {
			/RequestLine 	"GET /ftimage/foo/..?fobaz&..&..&X HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/EncodedCharactersTraversalAttack {
			/RequestLine 	"GET %2Fftimage/subimage/%2E.%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/UnicodeCharactersTraversalAttack {
			/RequestLine 	"GET %u002Fftimage/subimage%u002F%u002E%u002E%u002F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/EncodedRelativeBackMovementAttackWithArguments {
			/RequestLine 	"GET %2Fftimage%2Ffoo%2F%2E%2E?fobaz&..&..&X HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/DeepRelativeBackMovementAttack {
			/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/../../../../../etc/passwd HTTP/1.1\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/EncodedDeepRelativeBackMovementAttack {
			/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/UnicodeRelativeMovementAttack {
			/RequestLine 	"GET /ftimage/%u002e%u002e/image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/FixDirectoryTraversalRelativeMove {
			/RequestLine 	"GET /ftimage/subimage/../../etc/shadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveUnicode {
			/RequestLine 	"GET %u002Fftimage/subimage%u002F%u002E%u002E%u002F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveEncoded
		{
			/RequestLine 	"GET %2Fftimage/subimage/%2E.%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalManyRelativeMoves
		{
			/RequestLine 	"GET /ftimage/../../../etc/shadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalManyRelativeMovesEncoded
		{
			/RequestLine 	"GET %2Fftimage%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalManyRelativeMovesEncodedUnicode
		{
			/RequestLine 	"GET %2Fftimage%u002F%u002E%2E/%2E%2E%2F.%2E/etc%2Fshadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalManyRelativeMovesWithoutServiceName
		{
			/RequestLine 	"GET /../../../../etc/shadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalManyRelativeMovesWithoutServiceNameEncoded
		{
			/RequestLine 	"GET %2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/shadow"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveToRoot
		{
			/RequestLine 	"GET /ftimage/../../.. HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveToRootEncodedUnicode
		{
			/RequestLine 	"GET /ftimage%2F%2E%u002E%2F%2E%2E%2F%2E%2E HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMovesBeyondRootEncoded
		{
			/RequestLine 	"GET /ftimage%2F%2E%2E%2F%2E%2E%2F%2E%2E HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMovesBeyondRootTrailingSlash
		{
			/RequestLine 	"GET /ftimage/../../../ HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMovesBeyondRootTrailingSlashUnicode
		{
			/RequestLine 	"GET /ftimage%2F%2E%u002E%2F%2E%2E%2F%u002E%2E%2F HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDir
		{
			/RequestLine 	"GET /. HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDir
		{
			/RequestLine 	"GET %2F%2E HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirs
		{
			/RequestLine	"GET /./. HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirsEncoded
		{
			/RequestLine	"GET %2F%2E%2F%2E HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirWithservicename
		{
			/RequestLine	"GET /ftimage/./ HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirWithservicenameEncoded
		{
			/RequestLine	"GET %2Fftimage%2F%2E%2F HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirsWithservicename
		{
			/RequestLine	"GET /ftimage/./. HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirsWithservicename
		{
			/RequestLine	"GET %2Fftimage%2F%2E%2F%2E HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirServicename
		{
			/RequestLine	 "GET /ftimage/. HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeDirServicename
		{
			/RequestLine	 "GET %2Fftimage%2F%2E HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveWithArgs
		{
			/RequestLine 	"GET /ftimage/foo/..?fobaz&..&..&X HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage?fobaz&..&..&X"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveWithArgsEncoded
		{
			/RequestLine 	"GET %2Fftimage%2Ffoo%2F%2E%2E?fobaz&..&..&X HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage?fobaz&..&..&X"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeMoveWithArgsUnescaped
		{
			/RequestLine 	"GET %2Fftimage%2Ffoo%2F%2E%2E?fobaz%2F%u002F&..&..&X HTTP/1.0\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage?fobaz%2F%u002F&..&..&X"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalDeepRelativeBackMovementAttack
		{
			/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/../../../../../etc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/aa/bb/cc/dd/ee/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalDeepRelativeBackMovementAttackEncoded
		{
			/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/aa/bb/cc/dd/ee/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalDeepRelativeBackMovement
		{
			/RequestLine 	"GET /../../../../../etc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalDeepRelativeBackMovementEncoded
		{
			/RequestLine 	"GET %2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeBackMovement
		{
			/RequestLine 	"GET ../../../../../etc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversalRelativeBackMovement
		{
			/RequestLine 	"GET %2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDir
		{
			/RequestLine 	"GET /etc/./passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirEncoded
		{
			/RequestLine 	"GET /etc%2f%2e%2fpasswd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirs
		{
			/RequestLine 	"GET /etc/./././passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirsEncoded
		{
			/RequestLine 	"GET /etc%2f%2e%2f%2f%2e%2f%2f%2e%2fpasswd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirStart
		{
			/RequestLine 	"GET ./etc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirStartEncoded
		{
			/RequestLine 	"GET %2e%2fetc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirsStart
		{
			/RequestLine 	"GET ./././etc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirsStartEncoded
		{
			/RequestLine 	"GET %2e%2f%2e%2f%2e%2fetc/passwd HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirAndBlank
		{
			/RequestLine 	"GET ./././etc/passwd/my%20blank.gif HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd/my blank.gif"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithRelativeDirAndEqualChar
		{
			/RequestLine 	"GET ./././etc/passwd/my%3Dequals.gif HTTP/1.1\r\n\r\n"
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "etc/passwd/my=equals.gif"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/FixDirectoryTraversialWithExhaustiveDecode
		# multiple encodings. Only with FixDirectoryTraversial the modified request will be seen
		# and only if there had something to be fixed in the directory structure
		{
			/RequestLine 	"GET /ftimage%252F../image/my.gif HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	1
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/image/my.gif"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/DontFixDirectoryTraversialWithExhaustiveDecode
		{
			/RequestLine 	"GET /ftimage%252F../image/my.gif HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	1
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/FixDirectoryTraversialWithExhaustiveDecode
		# %%%25%25%32%35%25%25%37%35002%%%u0075004%u0035 evaluates to a .
		{
			/RequestLine 	"GET /ftimage%252F.%%%25%25%32%35%25%25%37%35002%%%u0075004%u0035/image/my.gif HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	1
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/image/my.gif"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Directory traversal attack detected and normalized. Request not rejected because of FixDirectoryTraversial setting"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/AbovehexFFfail {
			/RequestLine 	"GET %2Fftimage%2F%u01FFimage.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env *
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Encoded char above 0x255 detected"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/ArgumentsAreNotDecoded
		{
			/RequestLine 	"GET %2Fftimage%2Ffoo?fobaz%2F%u002F&..&..&X HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/foo?fobaz%2F%u002F&..&..&X"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/RemoveEmptyQueryChar
		{
			/RequestLine 	"GET /kimdojo? HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/kimdojo"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/RemoveEmptyQueryCharEncoded
		{
			/RequestLine 	"GET %2Fkimdojo? HTTP/1.1\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/kimdojo"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/OnlyQueryCharGiven
		{
			/RequestLine 	"GET ? HTTP/1.1\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI ""
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/RemoveEmptyQueryCharForRoot
		{
			/RequestLine 	"GET /? HTTP/1.1\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsCorrectlyEncodedRelative
		{
			/RequestLine 	"GET ?bar=%4B%69%6D-dojo& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "?bar=%4B%69%6D-dojo&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsCorrectlyEncodedForRoot
		{
			/RequestLine 	"GET /?bar=%4B%69%6D-dojo& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/?bar=%4B%69%6D-dojo&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsIncorrectlyEncodedForEncodedRoot
		{
			/RequestLine 	"GET %2F?bar=%4B%69%6D-~dojo& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Argument string (after ?) was not correctly encoded. Request not rejected."
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsCorrectlyEncodedWithOverrideSet
		{
			/RequestLine 	"GET %2F?bar=%4B%69%6D-~{dojo}& HTTP/1.0\r\n\r\n"
			/CheckUrlArgEncodingOverride	"%=-~{}&"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/?bar=%4B%69%6D-~{dojo}&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsCorrectlyEncodedWithservicename
		{
			/RequestLine 	"GET /ftimage/image.gif?bar=%4B%69%6D-dojo& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/image.gif?bar=%4B%69%6D-dojo&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsCorrectlyEncodedWithservicenameUnicode
		{
			/RequestLine 	"GET /ftimage/image.gif?bar=%u004B%u0069%u006D-dojo& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/image.gif?bar=%u004B%u0069%u006D-dojo&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/QueryArgumentsWithservicenameEncodedWIthIllegalArgumentChar
		{
			/RequestLine 	"GET %2Fftimage%2Fimage.gif?bar=%4B%69%6D-dojo~& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/image.gif?bar=%4B%69%6D-dojo~&"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Argument string (after ?) was not correctly encoded. Request not rejected."
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/argsabovehexFF
		{
			/RequestLine 	"GET /ftimage/image.gif?bar=%u01FF-dojo& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/image.gif?bar=%u01FF-dojo&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/Wrongpathencodings4casesbasingonsameurl
		{
			/RequestLine 	"GET /ftimage~/image.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Not all unsafe chars URL encoded"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/Wrongpathencodings4casesbasingonsameurlEncoded
		{
			/RequestLine 	"GET /ftimage%21/image.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage!/image.gif"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/NotEncodedBlankStringTriggerEndofPathParsing
		{
			/RequestLine 	"GET /ftimage/image withblank.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Bad request structure or simple HTTP/0.9 request"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/EncodedBlankStringResultsInBlankStringImageName
		{
			/RequestLine 	"GET /ftimage/image%20withblank.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/image withblank.gif"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/BackslashNotAllowedUnencoded
		{
			/RequestLine 	"GET /ftimage\image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Not all unsafe chars URL encoded"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/AfterFirstPassOfDecodingThereAreStillEncodedSequences
		{
			/RequestLine 	"GET /ftimage%255Cimage/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/"%25%35%63EvaluatesToBackslashWhichIsNotValid"
		{
			/RequestLine 	"GET /ftimage%25%35%63../image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/StillEncodedCharactersAfterFirstDecoding {
			/RequestLine 	"GET /ftimage%255C../ HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/"%%35cEvaluatesToBackslash"
		{
			/RequestLine 	"GET /ftimage%%35c../image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/EncodedCharsAboveAscii127
		{
			/RequestLine 	"GET /ftimage%C0%AF%C0%AF/image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/"%255CEvaluatesToBackslash"
		{
			/RequestLine 	"GET /ftimage%255C../image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/AfterOneTimeUrlDecodingThereAreNoMoreEscapedSquencesButInvalidChars
		{
			/RequestLine 	"GET /ftimage%255C..%255C..%255C../image/my.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/StillEncodedSsequencesAfterFirstPassOfDecoding
		{
			/RequestLine 	"GET /ftimage%252Fimage/my.gif HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	0
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/UnicodeCharAboveHex255
		{
			/RequestLine 	"GET /ftimage/%u0900/my.gif HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	1
			/FixDirectoryTraversial		1
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Encoded char above 0x255 detected"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/EqualsIsAllowedUnencoded
		{
			/RequestLine 	"GET /ftimage/my=equals.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/my=equals.gif"
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Not all unsafe chars URL encoded"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/"Allow]ToBeUnencodedInAdditionTo$-_.+/?%=ButOverrideCheckFails"
		{
			/RequestLine 	"GET /ftimage/my=]equals.gif HTTP/1.0\r\n\r\n"
			/CheckUrlEncodingOverride	"]"
			/Expected {
				/Request {
					/env {
					}
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/"Allow]ToBeUnencoded"
		{
			/RequestLine 	"GET /ftimage/my=]equals.gif HTTP/1.0\r\n\r\n"
			/CheckUrlEncodingOverride	"]"
			/CheckUrlPathContainsUnsafeCharsOverride	"<>\"#%{}|\\^~`"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/my=]equals.gif"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/ExtendedAsciiNotAllowedInURL
		{
			/RequestLine 	"GET /ftimage/%u0084umlaut.gif HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Decoded URL path contains unsafe char"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/UmlautsAllowedInUrlByOverride
		{
			/RequestLine 	"GET /ftimage/%u00e4%f6umlaut.gif HTTP/1.0\r\n\r\n"
			/CheckUrlPathContainsUnsafeCharsAsciiOverride "\xe4\xf6"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/\xE4\xF6umlaut.gif"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/"RemoveLessChar(%3c)FromDefaultSetOfOverrideChars"
		{
			/RequestLine 	"GET /ftimage/%3csmaller.gif HTTP/1.0\r\n\r\n"
			/CheckUrlPathContainsUnsafeCharsOverride ">\"#%{}|\\^~[]`"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/<smaller.gif"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/ExtendedAsciiCharsAbove127AllowedByOverride
		{
			/RequestLine 	"GET /ftimage%C0%AF%C0%AF/image/my.gif HTTP/1.0\r\n\r\n"
			/CheckUrlPathContainsUnsafeCharsDoNotCheckExtendedAscii 1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage\xC0\xAF\xC0\xAF/image/my.gif"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/SemicolonIsAllowedByRequestUriSplitter
		{
			/RequestLine 	"GET /ftimage/my.gif;ali=baba&gu^gus=da^da& HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/my.gif;ali=baba&gu^gus=da^da&"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/EncodedSemicolonIsAllowedByRequestUriSplitter
		{
			/RequestLine 	"GET /ftimage/my.gif%3Bali%3Dbaba HTTP/1.0\r\n\r\n"
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/my.gif;ali=baba"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/DeepEncodedSemicolonIsAllowedByRequestUriSplitter
		{
			/RequestLine 	"GET /ftimage/my.gif%3Bali%3Dbaba HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	1
			/FixDirectoryTraversial 1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/my.gif;ali=baba"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/EncodedQuestionMarkIsAllowedByRequestUriSplitter
		{
			/RequestLine 	"GET /ftimage/my.gif%3Fali%3Dbaba HTTP/1.0\r\n\r\n"
			/URLExhaustiveDecode	1
			/FixDirectoryTraversial 1
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/ftimage/my.gif?ali=baba"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/CoastEncodedUrlCorrectlyHandled
		{
			/RequestLine "GET /HOHO/X1=b64-Qmxvd2Zpc2hTY3JhbWJsZXIwLXX96LrMgzOhIOcV7UOg61cdj1zWDFjS-5Sc5kBT1Ny3DnBw$AqWARyPsxgNSEL-CKTFYIxOYDvUe-kVh8T8seKxEXwt1Jz3jbhFRL8F2H-dTzBQNREXwEb0vgSAbokMbTV2sKe3OMUycbR1XMJltJBBQmCLJftLOTB2BykamEifZr6HLCbpBWo=/X2=b64-Qmxvd2Zpc2hTY3JhbWJsZXIwLXX96LrMgzOh6cFdF2$cQwDVlebcVn528YGqxQD87Rx6mVExoiV0QSqQa8fhbZBIEgvJZkK9KM-1FHwMOVDED$OX$P747922UaPe2z0w-hc7Zbikt4J5lXw6LnMMxbVpUpY6Eq2GMZiX$BJHK6ShTTPp-pNtVJQH1bycxbhjYIGK-RUKctRb9GBGE7BQjs3YnjLtZgfCZb23LbVBp$VAMNaQGIDBcLj8s$wSRyukoU0zIaMNBRY40OrmY-Kbn-QdFfgpqrrn87NhvKa0LUwxDM97kKF9Huct16OuXMz3d43TdbHxcWPNG2JtamCFBlu99ef4auFCb5$irXyZVVAMja38EkcrpKFNM5ACilatcPTSo$l1LKcXgjLrsKOtWrR7i6T-Ycd8fSFk9CGQ6QXjGvrFDYatzRVKzzr5I5LwdoMvyye287qoJk-9lVnamBAh-A85YK3buLyily958HqK7dlaDJDpllUN4MsntvO6qCZPvZVZ2pgQIfgPOWCt27i8opcvefB6iu3ZVT$TewEFDpPOrThqpUvt8CMzljEkhjLNZTHUrlcV3vlEKro9ndQe6uxNFVGn32lwQz9NXNC02s8DBEJepA$Su1OW7BKBXusyGtZkElbWACaYuDdeN5c6VIesEOWsLhAacnJPII689AK3xKwnLV7KFjTIdGBp-eBmIsHnRwCLzFHhDFJ$eiUUMfxTcKZPD6iJf3kKALE4C6bdkUluWVZMElzMd4E161n1 HTTP/1.0\r\n\r\n"
			/URISizeLimit			2048
			/Expected {
				/Request {
					/env {
						/REQUEST_URI "/HOHO/X1=b64-Qmxvd2Zpc2hTY3JhbWJsZXIwLXX96LrMgzOhIOcV7UOg61cdj1zWDFjS-5Sc5kBT1Ny3DnBw$AqWARyPsxgNSEL-CKTFYIxOYDvUe-kVh8T8seKxEXwt1Jz3jbhFRL8F2H-dTzBQNREXwEb0vgSAbokMbTV2sKe3OMUycbR1XMJltJBBQmCLJftLOTB2BykamEifZr6HLCbpBWo=/X2=b64-Qmxvd2Zpc2hTY3JhbWJsZXIwLXX96LrMgzOh6cFdF2$cQwDVlebcVn528YGqxQD87Rx6mVExoiV0QSqQa8fhbZBIEgvJZkK9KM-1FHwMOVDED$OX$P747922UaPe2z0w-hc7Zbikt4J5lXw6LnMMxbVpUpY6Eq2GMZiX$BJHK6ShTTPp-pNtVJQH1bycxbhjYIGK-RUKctRb9GBGE7BQjs3YnjLtZgfCZb23LbVBp$VAMNaQGIDBcLj8s$wSRyukoU0zIaMNBRY40OrmY-Kbn-QdFfgpqrrn87NhvKa0LUwxDM97kKF9Huct16OuXMz3d43TdbHxcWPNG2JtamCFBlu99ef4auFCb5$irXyZVVAMja38EkcrpKFNM5ACilatcPTSo$l1LKcXgjLrsKOtWrR7i6T-Ycd8fSFk9CGQ6QXjGvrFDYatzRVKzzr5I5LwdoMvyye287qoJk-9lVnamBAh-A85YK3buLyily958HqK7dlaDJDpllUN4MsntvO6qCZPvZVZ2pgQIfgPOWCt27i8opcvefB6iu3ZVT$TewEFDpPOrThqpUvt8CMzljEkhjLNZTHUrlcV3vlEKro9ndQe6uxNFVGn32lwQz9NXNC02s8DBEJepA$Su1OW7BKBXusyGtZkElbWACaYuDdeN5c6VIesEOWsLhAacnJPII689AK3xKwnLV7KFjTIdGBp-eBmIsHnRwCLzFHhDFJ$eiUUMfxTcKZPD6iJf3kKALE4C6bdkUluWVZMElzMd4E161n1"
					}
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/CheckHeaderFieldsButDontReject
		{
			/RequestLine 	"GET /alibaba HTTP/1.0\r\nX-Evil: GET /gaga HTTP/1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 0
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL "GET /gaga HTTP/1.0"
						}
					}
				}
				/TmpStore {
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/CheckHeaderFieldsAndRejectGET
		{
			/RequestLine 	"GET /alibaba HTTP/1.0\r\nX-Evil: GET /gaga HTTP/1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "VerifyRequest.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Possible SSL Renegotiation attack. A header contains a GET/POST request"
				}
				/Reply	"HTTP/1.1 400 Bad Request"
			}
		}
		/CheckHeaderFieldsAndRejectPOST
		{
			/RequestLine 	"GET /alibaba HTTP/1.0\r\nX-Evil: POST\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
					}
				}
				/ErrorsSlotname "VerifyRequest.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Possible SSL Renegotiation attack. A header contains a GET/POST request"
				}
				/Reply	"HTTP/1.1 400 Bad Request"
			}
		}
		/CheckHeaderFieldsWithRejectIgnoreInvalidHeaderContent
		{
			/RequestLine 	"GET /alibaba HTTP/1.0\r\nX-Evil: vGET\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL "vGET"
						}
					}
				}
				/Reply	"HTTP/1.1 404 Not Found"
			}
		}
		/CheckHeaderFieldsWithRejectIgnoreInvalidHeaderContentAgain
		{
			/RequestLine 	"GET /alibaba HTTP/1.0\r\nX-Evil: vGET /gaga HTTP1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL "vGET /gaga HTTP1.0"
						}
					}
				}
				/Reply	"HTTP/1.1 404 Not Found"
			}
		}
		/EmptyRequestLineIsNotValid
		{
			/RequestLine "\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5121
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Empty request line"
				}
				/Reply	"HTTP/1.1 400 Bad Request"
			}
		}
		/RequestLineWithEmptyUrlIsNotValid
		{
			/RequestLine "GET  HTTP/1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Bad request structure or simple HTTP/0.9 request"
				}
				/Reply	"HTTP/1.1 400 Bad Request"
			}
		}
		/RequestLineFailsBecauseOfLimitedURISize
		{
			/RequestLine "GET /12345678 HTTP/1.0\r\n\r\n"
			/URISizeLimit		8
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Request-URI too long; max: 8 actual: 9 => check setting of [URISizeLimit]"
				}
				/Reply	"HTTP/1.1 414 Request-URI Too Large"
			}
		}
		/RequestLineFailsBecauseOfLimitedLineSize
		{
			/RequestLine "GET /12345 HTTP/1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		8
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Line size exceeded; max: 8 actual: 9 => check setting of [LineSizeLimit]"
				}
				/Reply	"HTTP/1.1 413 Request Entity Too Large"
			}
		}
		/RequestLineFailsBecauseOfLimitedRequestSize
		{
			/RequestLine "GET / HTTP/1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	8
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"RequestSizeLimit exceeded; max: 8 actual: 16 => check setting of [RequestSizeLimit]"
				}
				/Reply	"HTTP/1.1 413 Request Entity Too Large"
			}
		}
		/InvalidRequestMethod
		{
			/RequestLine "xxGET / HTTP/1.0\r\n\r\n"
			/URISizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Method Not Allowed"
				}
				/Reply "HTTP/1.1 405 Method Not Allowed"
			}
		}
		/RenegotiationAttackRejectedBecauseOfHeaderFieldWithGetRequest
		{
			/RequestLine {
				"POST /alibaba HTTP/1.0\r\n"
				"X-Evil: GET /gaga HTTP/1.0\r\n"
				"Content-type: application/x-www-form-urlencoded\r\n"
				"Content-length: 11\r\n"
				"\r\n"
				"key=value\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	POST
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL "GET /gaga HTTP/1.0"
							/CONTENT-TYPE "application/x-www-form-urlencoded"
							/CONTENT-LENGTH "11"
						}
						/REQUEST_BODY {
							/key "value"
						}
						/WHOLE_REQUEST_BODY "key=value\x0D\n"
					}
				}
				/TmpStore {
				}
				/ErrorsSlotname "VerifyRequest.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Possible SSL Renegotiation attack. A header contains a GET/POST request"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/RenegotiationAttackRejectedBecauseOfHeaderFieldWithPOSTRequest
		{
			/RequestLine {
				"GET /alibaba HTTP/1.0" "\r\n" "X-Evil: POST" "\r\n" "\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL	POST
						}
					}
				}
				/TmpStore {
				}
				/ErrorsSlotname "VerifyRequest.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Possible SSL Renegotiation attack. A header contains a GET/POST request"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/RenegotiationAttackRejectedBecauseOfHeaderFieldWithGETRequest
		{
			/RequestLine {
				"GET /alibaba HTTP/1.0" "\r\n" "X-Evil: GET" "\r\n" "\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL	GET
						}
					}
				}
				/TmpStore {
				}
				/ErrorsSlotname "VerifyRequest.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Possible SSL Renegotiation attack. A header contains a GET/POST request"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/RenegotiationAttackBecauseOfHeaderFieldWithGETRequestButNotRejected
		{
			/RequestLine {
				"GET /alibaba HTTP/1.0" "\r\n" "X-Evil: GET" "\r\n" "\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 0
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL	GET
						}
					}
				}
				/TmpStore {
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/RenegotiationAttackWithHeaderFieldsButInvalidGETRequest
		{
			/RequestLine {
				"GET /alibaba HTTP/1.0" "\r\n" "X-Evil: xGET" "\r\n" "\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	GET
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/header {
							/X-EVIL	xGET
						}
					}
				}
				/TmpStore {
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/RenegotiationAttackRejectedInMimeMultipart
		{
			/RequestLine {
				"POST /alibaba HTTP/1.0\r\n"
				"Content-type: multipart/form-data; boundary=me\r\n"
				"Content-length: 64\r\n\r\n"
				"--me\r\n"
				"X-Evil: GET /gaga HTTP/1.0\r\n\r\n"
				"This is the content.\r\n"
				"--me--\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	POST
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
						/REQUEST_BODY:0.header {
							/X-EVIL	"GET /gaga HTTP/1.0"
						}
					}
				}
				/TmpStore {
				}
				/ErrorsSlotname "VerifyRequest.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Possible SSL Renegotiation attack. A multipart mime header (in POST) contains a GET/POST request"
				}
				/Reply "HTTP/1.1 400 Bad Request"
			}
		}
		/RenegotiationAttackInMimeMultipartButInvalidMimePart
		{
			/RequestLine {
				"POST /alibaba HTTP/1.0\r\n"
				"Content-type: multipart/form-data; boundary=me\r\n"
				"Content-length: 64\r\n\r\n"
				"--me\r\n"
				"X-Evil: GET /gaga HTTP/1.0\r\n"
				"This is the content.\r\n"
				"--me--\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	POST
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
					}
				}
				/TmpStore {
				}
				/ErrorsSlotname "ReadInput.Error"
				/ErrorMessages {
					/:0.ErrorMessage	"Missing header field name"
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
		/RenegotiationAttackInMimeMultipartButInvalidGetRequest
		{
			/RequestLine {
				"POST /alibaba HTTP/1.0\r\n"
				"Content-type: multipart/form-data; boundary=me\r\n"
				"Content-length: 64\r\n\r\n"
				"--me\r\n"
				"X-Evil: xGET /gaga HTTP/1.0\r\n\r\n"
				"This is the content.\r\n"
				"--me--\r\n"
			}
			/URISizeLimit		1024
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/CheckHeaderFields	1
			/RejectRequestsWithInvalidHeaders 1
			/Expected {
				/Request {
					/env {
						/REQUEST_METHOD	POST
						/REQUEST_URI "/alibaba"
						/SERVER_PROTOCOL "HTTP/1.0"
					}
				}
				/TmpStore {
				}
				/Reply "HTTP/1.1 404 Not Found"
			}
		}
	}
}
